# This ansible playbook will provision our core services.

- hosts: core_server
  tasks:
    - name: Setup cpmeta proxy
      tags:
        - proxy
        - cpmeta_proxy
      import_role:
        name: icos.cpmeta
        tasks_from: proxy.yml

    - name: Setup cpdata proxy
      tags:
        - proxy
        - cpdata_proxy
      import_role:
        name: icos.cpdata
        tasks_from: proxy.yml

    - name: Setup cpauth proxy
      tags:
        - proxy
        - cpauth_proxy
      import_role:
        name: icos.cpauth
        tasks_from: proxy.yml


- hosts: core_host
  roles:
    - role: icos.cpmeta
    - role: icos.cpdata
    - role: icos.cpauth
    - role: icos.doi
    - role: icos.nexus
    - role: icos.rdflog
