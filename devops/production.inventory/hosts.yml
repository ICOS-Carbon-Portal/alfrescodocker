all:
  # GLOBAL VARS
  vars:
    ansible_user: root
    ansible_python_interpreter: /usr/bin/python3
    quince_ext_port: 60522
    bbclient_remotes:
      - fsicos2.lunarc.lu.se
      - cdb.nateko.lu.se

    fsicos1_ip: 194.47.223.133
    fsicos2_ip: 194.47.223.139
    fsicos3_ip: 194.47.223.137
    cdb_ip: 130.235.99.237

    node_exporter_allow_from: '{{ cdb_ip }}'
    prometheus_ansible_path: /docker/prometheus/volumes/prometheus_conf/ansible

  hosts:

  children:
    # PHYSICAL SERVERS
    physical_servers:
      vars:
        smartmon_enable: true
        dirsize_enable: true
      hosts:
        cdb.nateko.lu.se:
        icos1.gis.lu.se:
        fsicos2.lunarc.lu.se:
        fsicos3.lunarc.lu.se:

    # ICOS1 WIREGUARD
    wg_icos1_hosts:
      vars:
        wg_icos1_config:
          name: icos1
          allowed_ips: 172.30.1.0/24
          hub:
            addr: icos1.gis.lu.se
            port: 60800
          peers:
            icos1.gis.lu.se:
              name: icos1
              addr: 172.30.1.1
            fsicos2.lunarc.lu.se:
              name: fsicos2
              addr: 172.30.1.2
              port: 60800
            fsicos3.lunarc.lu.se:
              name: fsicos3
              addr: 172.30.1.3
              port: 60800
      hosts:
        icos1.gis.lu.se:
        fsicos2.lunarc.lu.se:
        fsicos3.lunarc.lu.se:

    # CDB VMS
    cdb_vms:
      vars:
        ansible_host: cdb.nateko.lu.se
      hosts:
        pgrep-rdflog@cdb:
          ansible_port: 60550
          pgrep_arg:
            suffix: rdflog
            peer_user: pgrepuser
            peer_host: fsicos2.lunarc.lu.se
            peer_port: 60002
            peer_slot: cdb
            peer_pass: "{{ vault_rdflog_rep_pass }}"
            peer_cert: roles/icos.rdflog/files/server.crt
        prometheus:
          ansible_port: 60545

    # FSICOS2 VMS
    fsicos2_vms:
      vars:
          ansible_host: fsicos2.lunarc.lu.se
      hosts:
        eddyetc:
          ansible_port: 60523
        erddap:
          ansible_port: 60580
        flexextract:
          ansible_port: 60526
        postgis:
          ansible_port: 60590
        quince:
          quince_ext_port: 60522
          ansible_port: '{{ quince_ext_port }}'
        rspamd:
          ansible_port: 60585
        wordpress:
          ansible_port: 60552
        restore:
          ansible_port: 60505

    # FSICOS3 VMS
    fsicos3_vms:
      vars:
        ansible_host: fsicos3.lunarc.lu.se
      hosts:
        amalthea:
          ansible_port: 60560
        callisto:
          ansible_port: 60510
          docker_prevent_upgrade: True
        exploredata:
          ansible_port: 60555
          docker_prevent_upgrade: True
        flexpart:
          ansible_port: 60530
          docker_prevent_upgrade: True
        ganymede:
          ansible_port: 60540
          docker_prevent_upgrade: True
        jupyter:
          ansible_port: 60535
          docker_prevent_upgrade: True
          bbclient_name: jupyter
        molefractions:
          ansible_port: 60515
        nats3:
          ansible_port: 60550
        registry:
          ansible_port: 60545
        pgrep-rdflog@fsicos3:
          ansible_port: 60570
          pgrep_arg:
            suffix: rdflog
            peer_user: pgrepuser
            peer_host: fsicos2.lunarc.lu.se
            peer_port: 60002
            peer_slot: fsicos3
            peer_pass: "{{ vault_rdflog_rep_pass }}"
            peer_cert: roles/icos.rdflog/files/server.crt
        ctehires:
          ansible_port: 60575

    # OTHER GROUPS
    bbservers:
      hosts:
        cdb.nateko.lu.se:
          bbserver_home: /disk/data/bbserver
        fsicos2.lunarc.lu.se:
          bbserver_home: /disk/data/bbserver
    node_exporters:
      hosts:
        fsicos2.lunarc.lu.se:
        fsicos3.lunarc.lu.se:
