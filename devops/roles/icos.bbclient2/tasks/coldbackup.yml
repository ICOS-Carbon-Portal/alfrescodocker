- name: Create coldbackup helper scripts
  template:
    src: "{{ item }}"
    dest: "{{ bbclient_bin_dir }}"
    mode: +x
  loop:
    - bbclient-coldbackup
    - bbclient-coldrestore

- name: Add coldbackup to crontab
  cron:
    job: "{{ bbclient_bin_dir }}/bbclient-coldbackup"
    hour: "{{ bbclient_coldbackup_hour }}"
    minute: "{{ bbclient_coldbackup_minute }}"
    state: present
    name: "bbclient_{{ bbclient_name }}_coldbackup"
  when: bbclient_coldbackup is defined

- name: Create patterns.lst
  copy:
    dest: "{{ bbclient_patterns }}"
    content: "{{ bbclient_coldbackup_patterns }}"
  when: bbclient_coldbackup_patterns is defined
