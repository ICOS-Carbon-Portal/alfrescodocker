- name: Create {{ climbeco_home }} directory
  file:
    path: "{{ climbeco_home }}"
    state: directory

- name: Copy build files
  copy:
    src: build.hub
    dest: "{{ climbeco_home }}"

- name: Create runtime files
  template:
    src: "{{ item }}"
    dest: "{{ climbeco_home }}"
  loop:
    - jupyterhub_config.py
    - docker-compose.yml

- name: Create initial password
  shell: openssl rand -hex 10 > password.txt
  args:
    chdir: "{{ climbeco_home }}"
    creates: password.txt

- name: Make sure that users.txt exists
  copy:
    dest: "{{ climbeco_home }}/users.txt"
    force: no
    content: ""
