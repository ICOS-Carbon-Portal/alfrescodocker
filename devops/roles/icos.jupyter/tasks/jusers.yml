- name: Create virtual env
  pip:
    virtualenv: /opt/jusers/venv
    name:
      - ruamel.yaml
      - click
      - pandas
      - requests
    state: present

- name: Copy jusers.py
  tags: jupyter_jusers_deploy
  copy:
    src: jusers.py
    dest: /opt/jusers/jusers.py
    mode: +x

- name: Copy readme_template.html
  tags: jupyter_jusers_deploy
  copy:
    src: readme_template.html
    dest: /root/jusers/readme_template.html
    mode: +r

- name: Create /usr/local/sbin/jusers symlink
  file:
    dest: "/usr/local/sbin/jusers"
    src: /opt/jusers/jusers.py
    state: link
