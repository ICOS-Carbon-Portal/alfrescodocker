- name: Install python 3.8
  when: ansible_facts['python_version'] is version('3.8', '<')
  apt:
    name:
      - python3.8
      - python3.8-venv

- name: Install pip and venv
  apt:
    name:
      - python3-venv
      - python3-pip
      - python3-virtualenv
      - python3-click
      # On some targets, this is required for the ansible 'pip' module.
      - virtualenv

# This is recommended by pip itself when it fails to install some packages.
- name: Upgrade to latest pip (using pip!)
  pip:
    name: pip
    state: latest

# Making python3.8 the default python means that system utilities - like apt(1)
# - will use it. That will not always work. In the case of apt it'll crash
# which render the ansible apt module inoperable.
#
# - name: Make python3.8 the default python3
#   community.general.alternatives:
#     name: python3
#     link: /usr/bin/python3
