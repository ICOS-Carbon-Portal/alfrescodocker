# First install pip and venv for the system version of python. This is for the
# sake of later ansible modules.
- name: Install pip and venv
  apt:
    # This role is included by lxd_guest, and as such is often the first
    update_cache: true
    name:
      - python3-pip
      - python3-virtualenv
      # On some targets, this is required for the ansible 'pip' module.
      - virtualenv

# Now check whether we need to install our own version of
- import_tasks: install.yml
  when: python3_should_install
  tags: python3_install

# Install packages for our preferred python3
- name: pip install packages
  pip:
    name:
      - click>=8
      - pyyaml
    state: present
    executable: "{{ python3_pip }}"
